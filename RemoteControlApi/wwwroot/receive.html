<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Notifications</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>Notifications</h1>
  <ul id="list"></ul>
  <script>
    const list = document.getElementById('list');
    function add(n) {
      const li = document.createElement('li');
      li.textContent = `${n.title}: ${n.body}`;
      list.prepend(li);
    }
    async function load() {
      const res = await fetch('/api/control/get-notifications');
      const json = await res.json();
      list.innerHTML = '';
      json.items.forEach(add);
    }
    load();
    const evt = new EventSource('/api/control/notifications-stream');
    evt.onmessage = e => add(JSON.parse(e.data));
  </script>
</body>
</html>
